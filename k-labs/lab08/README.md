# Lab08A  
* Node Prep 

# Step 1
* Increase node count to 3 

```sh 

kubectl get nodes

az aks scale --resource-group aks_rg --name aks_lab --node-count 3
* This might take 3 - 5 minute, if it fails, rerun the command
* The command will add additional node to your Kubernetes Cluster 
* DO NOT increase the node count to more than 3 ! 

kubectl get nodes
* Node names are generated by Azure Automatically, but will have ordered suffix eg 0,1,2.. 

kubectl get pods --field-selector=spec.nodeName=aks-XXXXXXXX-0 -A

kubectl get pods --field-selector=spec.nodeName=aks-XXXXXXXX-1 -A

kubectl get pods --field-selector=spec.nodeName=aks-XXXXXXXX-2 -A

```

# Step 2
* Deploy sample DaemonSets
```sh 

kubectl apply -f kubia-ds-1.yaml

kubectl get ds

kubectl get pod 

kubectl get pod --selector=app=kubiads -o wide

kubectl drain aks-XXXX-XXXX-2 --ignore-daemonsets

kubectl get nodes

kubectl get pod --selector=app=kubiads -o wide

kubectl get pod --field-selector=spec.nodeName=aks-agentpool-25073747-2 -A

kubectl apply -f kubia-ds-2.yaml

kubectl get pod --selector=app=kubiads2 -o wide

kubectl uncordon aks-agentpool-25073747-2

kubectl get  nodes

kubectl get pod --selector=app=kubiads -o wide

kubectl get pod --selector=app=kubiads2 -o wide

kubectl get ds

```
# Lab08B
# Step 1
```sh
kubectl get node

kubectl label node  aks-XXXX-XXXX-1 disk=ssd

kubectl label node  aks-XXXX-XXXX-2 disk=ssd

kubectl create -f ssd-monitor-daemonset.yaml

kubectl get ds

kubectl get pod --selector=app=ssd-monitor -o wide

kubectl label node aks-XXXX-XXXX-2 disk=hdd --overwrite

kubectl get ds

kubectl get pod --selector=app=ssd-monitor -o wide

kubectl label node  aks-XXXX-XXXX-0 disk=ssd
```

# Step 2
```sh 
kubectl get nodes

az aks scale --resource-group aks_rg --name aks_lab --node-count 4
* This might take 3 - 5 minute, if it fails, rerun the command
* The command will add additional node to your Kubernetes Cluster 
* DO NOT increase the node count to more than 4 ! 

kubectl get nodes
* Node names are generated by Azure Automatically, but will have ordered suffix eg 0,1,2,3..

kubectl get ds

kubectl get pod --selector=app=kubiads -o wide

kubectl get pod --selector=app=kubiads2 -o wide

kubectl get pod --selector=app=ssd-monitor -o wide

kubectl get nodes -L disk

kubectl label node  aks-XXXX-XXXX-3 disk=ssd

kubectl get pod --selector=app=ssd-monitor -o wide

kubectl get nodes -L disk

kubectl label node aks-agentpool-25073747-0 disk-

kubectl label node aks-agentpool-25073747-1 disk-

kubectl label node aks-agentpool-25073747-2 disk-

kubectl label node aks-agentpool-25073747-3 disk-

kubectl get pod --selector=app=ssd-monitor -o wide

kubectl get ds

kubectl delete -f kubia-ds-1.yaml

kubectl delete -f kubia-ds-2.yaml

kubectl delete -f ssd-monitor-daemonset.yaml

```

# Step 3 
* Clean Up 
* remove additional Nodes 

```sh 

az aks scale --resource-group aks_rg --name aks_lab --node-count 2

```
